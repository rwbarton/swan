\documentclass[11pt]{article}
 
\usepackage[margin=1in]{geometry} 
\usepackage{tikz-cd}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{amsmath,amsthm,amssymb,mathrsfs,mathabx}
\usepackage{enumitem}
\usepackage{csquotes}
\usepackage{color} 
\usepackage{parskip}
\usepackage{hyperref}
\usepackage{fixltx2e}
\usepackage{tcolorbox}
\usepackage{listings}

\newcommand{\R}{\mathbb{R}}
\newcommand{\remph}[1]{\textcolor{red}{#1}}
\newcommand{\TODO}{\remph{TODO}}
\newcommand{\Hom}{\operatorname{Hom}}
\newcommand{\Mat}{\operatorname{Mat}}
\newcommand{\Vect}{\operatorname{Vect}}
\newcommand{\fgProj}{\operatorname{fgProj}}
\newcommand{\Shv}{\operatorname{Shv}}
\newcommand{\RHom}[3]{\Hom_{{#1}\text{-Mod}}({#2}, {#3})}
\newcommand{\im}{\operatorname{im}}
\renewcommand{\ker}{\operatorname{ker}}
\mathchardef\mhyphen="2D
\newcommand{\Mod}{\mhyphen\operatorname{Mod}}
\newcommand{\wt}{\widetilde}
\newcommand{\id}{\operatorname{id}}

\theoremstyle{plain}
\newtheorem{lemma}{Lemma}[section]
\newtheorem{theorem}{Theorem}[section]

\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]
\newtheorem{example}{Example}[section]

\bibliographystyle{plainurl}

\usepackage{color}
\definecolor{keywordcolor}{rgb}{0.7, 0.1, 0.1}   % red
\definecolor{tacticcolor}{rgb}{0.1, 0.2, 0.6}    % blue
\definecolor{commentcolor}{rgb}{0.4, 0.4, 0.4}   % grey
\definecolor{symbolcolor}{rgb}{0.0, 0.1, 0.6}    % blue
\definecolor{sortcolor}{rgb}{0.1, 0.5, 0.1}      % green
\definecolor{attributecolor}{rgb}{0.7, 0.1, 0.1} % red

\usepackage{listings}
\def\lstlanguagefiles{lstlean.tex}
\lstset{language=lean,breakatwhitespace,xleftmargin=0pt, basicstyle=\ttfamily\small}
\usepackage{stmaryrd}
\newcommand{\B}{\mathbb{B}}
\newcommand{\lil}{\lstinline}
\newcommand{\N}{\mathbb{N}}

\begin{document}

\title{Swan's theorem}
\author{Jesse Han}
\date{\today}

\maketitle

\begin{abstract}
We give an account of Swan's theorem characterizing vector bundles over a compact Hausdorff space.
\end{abstract}

\section*{Introduction}
% TODO

\section{Vector bundles}
For the rest of this document, we fix a compact Hausdorff space \(X\). \(C(X)\) denotes the ring of continuous real-valued functions on \(X\).
% TODO: rephrase in terms of fiber functions
\begin{definition}

\label{def-vector-bundle}
 A (real) \textbf{vector bundle over \(X\)} comprises the following data:
  \begin{enumerate}[label={(\roman*)}]
  \item A topological space \(E\), called the \textbf{total space},
  \item a map of topological spaces \(E \overset{p}{\to} X\),
  \item on every \emph{fiber} \(E_x := p^{-1}(x)\), the structure of an \(\R\)-vector space on \(E_x\), and
  \item for every \(x : X\), an open neighborhood \(x \in U_x \subseteq X\), an \(n_x : \N\), and a homeomorphism \(\Phi_x : U_x \times \R^{n_x} \to p^{-1}(U)\),
  \end{enumerate}

  satisfying the following properties:
\begin{enumerate}[label={(\alph*)}]
  \item For every \(x : X\), the dimension of the vector space \(E_x\) is finite,
  \item \label{local-triviality} for every \(x : X\), \(\Phi_x\) is linear on every fiber, and satisfies \(p \circ \Phi_x = (\pi_1 : U_x \times \R^{n_x} \twoheadrightarrow U_x)\).
\end{enumerate}  
\end{definition}

\begin{example}\label{example-trivial-bundle}
  The property \ref{local-triviality} is called \textbf{local triviality}. Accordingly, for every \(n : \N\), we define the \textbf{trivial bundle} of rank \(n\) to be
  \[
    X \times \R^n \overset{\pi_1}{\twoheadrightarrow} X.
  \]
\end{example}

\begin{example}\label{example-tangent-bundle}
  Suppose that \(X\) additionally has the structure of a smooth manifold. The \textbf{tangent bundle} of \(X\) is defined as follows: the total space is sigma-type of all tangent spaces at all points of \(X\).

  \TODO(jesse): describe the topology, smooth structure, etc.
\end{example}

\begin{definition}\label{def-rank}
  Let \(E \overset{p}{\to} X\) be a vector bundle. Let \(x : X\). The \textbf{rank of \(E\) at \(x\)} is the dimension of the vector space \(E_x\).
\end{definition}

\begin{lemma}\label{lemma-rank-locally-constant}
  Rank is a locally constant function. That is, for every \(x : X\), there is a neighborhood \(V_{x}\) of \(x\) such that the rank of \(E\) is constant on \(V_x\).
\end{lemma}

\begin{proof}
  \TODO(jesse).
\end{proof}

\begin{definition} \label{def-vector-bundle-homomorphism}
  Let \(E_1 \overset{p_1}{\to} X\) and \(E_2 \overset{p_2}{\to} X\) be vector bundles over \(X\).
  A \textbf{vector bundle morphism} is a map \(f : E_1 \to E_2\) over \(X\) such that for every \(x : X\), \(E_{1,x} \overset{f}{\to} E_{2,f(x)}\) is also a map of vector spaces.
\end{definition}

\begin{definition} \label{def-category-vector-bundles}
  We define \(\Vect(X)\), the category of vector bundles over \(X\), to be the category whose objects are the vector bundles over \(X\) and whose morphisms are the vector bundle morphisms.
\end{definition}

\begin{definition}\label{def-global-sections}
  Let \(E \overset{p}{\to} X\) be a vector bundle over \(X\). The \textbf{global sections} of \(E\) are the set of continuous right-inverses to \(p\). We denote the global sections of \((E,p)\) by \(\Gamma((E,p))\).  
\end{definition}

\begin{lemma}\label{lemma-global-sections-module}
  For every vector bundle \((E,p)\), \(\Gamma((E,p))\) is a \(C(X)\)-module.
\end{lemma}
\begin{proof}
  Let \(\sigma : X \to E\) be a section, and let \(c : X \to \R\) be an element of \(C(X)\). The scalar multiplication is given by \(c \cdot x := \lambda \hspace{2mm} z, c(z) \cdot s(z)\).\footnote{Note that here, the vector space structure on \(E_x\) is essential.}
\end{proof}

\begin{definition}\label{def-global-sections-functor}
  More generally, we define the \textbf{global sections functor}
  \[\Gamma : \Vect(X) \to C(X)\Mod\]
  as follows:
  \begin{itemize}
  \item On an object \((E,p)\), \(\Gamma((E,p))\) is the module of global sections of \((E,p)\), and
    \item On a map \(f : (E,p) \to (E',p')\), \(\Gamma(f) : \Gamma((E,p)) \to \Gamma((E',p'))\) is the map which sends a global section \(X \overset{\sigma}{\to} E\) to the global section \(X \overset{\sigma}{\to} E \overset{f}{\to} E'\).
    \end{itemize}

    \begin{proof}[\(\Gamma\) is functorial]
      We need to verify that \(\Gamma(\id) = \id\) and that for all vector bundle morphisms \(f,g\), \(\Gamma(g \circ f) = \Gamma(f) \circ \Gamma(g)\).
      \begin{itemize}
      \item If \((E,p) \to (E,p)\) is the identity of \((E,p)\), then for every global section \(\sigma : X \to E\) of \((E,p)\), \(\Gamma(\id)(\sigma) = \id \circ \sigma = \sigma\), so \(\Gamma\) is equal to \(\id\).

        \item If \((E,p) \overset{f}{\to} (E',p') \overset{g}{\to} (E'', p'')\) is a composition of vector bundle maps, then we see that for an arbitrary section \(\sigma : X \to E\), \(\Gamma(g \circ f)(\sigma) = g \circ f \circ \sigma = \Gamma(g)(\Gamma(f)(\sigma))\).
      \end{itemize}
    \end{proof}

    \begin{proof}[For every vector bundle map \(f : (E,p) \to (E',p')\), \(\Gamma(f)\) is \(C(X)\)-linear]
      We need to verify that \(\Gamma(f)\) is additive and that \(\Gamma(f)\) is \(C(X)\)-equivariant.
      \begin{itemize}
      \item Let \(\sigma_1, \sigma_2 : X \to E\) be global sections. Then
        \[\Gamma(f)(\sigma_1 + \sigma_2) = f \circ (\sigma_1 + \sigma_2) = \lambda x, f(\sigma_1 + \sigma_2)(x) = \lambda x, f(\sigma_1(x) + \sigma_2(x))\]\[ = \lambda x, f(\sigma_1(x)) + f(\sigma_2(x)) = \Gamma(f)(\sigma_1) + \Gamma(f)(\sigma_2).\]
        \item Let \(c \in C(X)\). Then \[\Gamma(f)(c \cdot \sigma) = \lambda x, f \circ (c(x) \cdot \sigma(x)) = c(x) \cdot (f(\sigma(x))) = c \cdot \Gamma(\sigma).\]
      \end{itemize}
    \end{proof}
  
\end{definition}

\begin{definition}\label{def-local-base}
  Let \((E,p)\) be a vector bundle over \(X\). Let \(x : X\). We define a \textbf{local base} for \((E,p)\) at \(x\) to be the following data:
  \begin{enumerate}[label={(\alph*)}]
  \item An open set \(U\), such that \(U \ni x\),
  \item Finitely many continuous local sections \(s_1, \dots, s_n : U \to E\), such that for every \(y \in U\), \(s_1(y), \dots, s_n(y)\) form a basis for \(E_y\).
  \end{enumerate}
\end{definition}

\section{Projective modules}
Throughout this section, we fix a commutative ring \(R\).

\begin{definition} \label{def-left-exact}
  Let \(R\) and \(S\) be rings. We say that a functor \(F : R\Mod \to S\Mod\) is \textbf{left-exact} if it preserves \(0\) and direct sums, and for every short exact sequence \(0 \to A \overset{f_1}{\to} B \overset{f_2}{\to} C \to 0\) in \(R\Mod\),
  \[0 \to F(A) \overset{F(f_1)}{\to} F(B) \overset{F(f_2)}{\to} F(C)\]
  is a short exact sequence in \(S\Mod\)
\end{definition}

\begin{definition} \label{def-right-exact}
  Let \(R\) and \(S\) be rings. We say that a functor \(F : R\Mod \to S\Mod\) is \textbf{left-exact} if it preserves \(0\) and direct sums, and for every short exact sequence \(0 \to A \overset{f_1}{\to} B \overset{f_2}{\to} C \to 0\) in \(R\Mod\),
  \[F(A) \overset{F(f_1)}{\to} F(B) \overset{F(f_2)}{\to} F(C) \to 0\]
  is a short exact sequence in \(S\Mod\).
\end{definition}

\begin{lemma}\label{lemma-left-exact-finite-limits}
  \(F : R\Mod \to S\Mod\) is left exact if and only if \(F\) preserves finite limits.
\end{lemma}

\begin{lemma}\label{lemma-right-exact-finite-limits}
  \(F : R\Mod \to S\Mod\) is right exact if and only if \(F\) preserves finite colimits.
\end{lemma}

\begin{lemma}\label{lemma-covariant-hom-left-exact}
  Let \(M\) be an \(R\)-module. Then the covariant hom-functor \(\RHom{R}{M}{-}\) is left-exact.
\end{lemma}

\begin{proof}
  We need to show that for every exact sequence \(0 \to A \overset{f_1}{\to} B \overset{f_2}{\to} C \to 0\),
  \[0 \to \RHom{R}{M}{A} \overset{f_1 \circ -}{\to} \RHom{R}{M}{B} \overset{f_2 \circ -}{\to} \RHom{R}{M}{C}\]
  is exact.

  That is, we need to show that
  \begin{enumerate}
  \item \label{lemma-covariant-hom-left-exact-1}\(f_1 \circ -\) is injective.
  \item \label{lemma-covariant-hom-left-exact-2} \(\im(f_1 \circ -) = \ker(f_2 \circ -)\).
  \end{enumerate}

First, we prove  \ref{lemma-covariant-hom-left-exact-1}.
    Let \(g_1, g_2 : M \to A\) such that \(f_1 \circ g_1 = f_1 \circ g_2\). By assumption on \(f_1\), \(f_1\) is injective, so it follows that \(g_1 = g_2\).

Now we prove \ref{lemma-covariant-hom-left-exact-2}.
    Let \(g : M \to A\). Then \(f_2 \circ f_1 \circ g : M \to C\) is zero because \(f_2 \circ f_1\) is zero, which shows that \(\im(f_1 \circ -) \subseteq \ker(f_2 \circ -)\). For the other inclusion, let \(h : M \to B\)  such that \(f_2 \circ h = 0\). It suffices to exhibit a \(g : M \to A\) such that \(f_1 \circ g = h\). We define \(g\) pointwise. Fix \(m \in M\). Since \(f_2 \circ h = 0\), we have that \(\im(h) \subseteq \ker(f_2)\). By assumption on \(f_2\), \(\ker(f_2) = \im(f_1)\), so \(\im(h) \subseteq \im(f_1)\). That is, there exists some \(a \in A\) such that \(h(m) = f_1(a)\). We define \(g(m) = a\). Since \(f_1\) is injective, this function is well-defined and is easily checked to be an \(R\)-module homomorphism.

  \end{proof}

  \begin{definition}[\cite{nlab:projective_module}]\label{def-projective}
  Let \(M\) be an \(R\)-module. \(M\) is projective if it satisfies any of the following properties:

  \begin{enumerate}
  \item\label{projective-lifting} For any \(A, B\), \(f : M \to B\) and \(g : A \twoheadrightarrow B\), there exists a lift \(\widetilde{f}\):
    \[
      \begin{tikzcd}
        & A \arrow[two heads]{d}{g}\\
        M \arrow[dashed]{ur}{\widetilde{f}}\arrow[swap]{r}{f}& B
      \end{tikzcd}
    \]
  \item \label{projective-free-summand} \(M\) is a direct summand of a free module.

    \item \label{projective-split} Every short exact sequence \(0 \to A \to B \to M \to 0\) is split.

    \item \label{projective-hom-exact} The covariant hom-functor \(\Hom_{R\text{-Mod}}(M, -)\) is exact.
  \end{enumerate}
\end{definition}

\begin{lemma}\label{lemma-projective-equivalent}
  The properties \ref{projective-lifting}, \ref{projective-free-summand}, \ref{projective-split}, and \ref{projective-hom-exact} are equivalent.
\end{lemma}
\begin{proof}
  \begin{itemize}
  \item (\ref{projective-lifting} \(\implies\) \ref{projective-hom-exact})
    Let \(0 \to A \overset{f_1}{\to} B \overset{f_2}{\to} C \to 0\) be an exact sequence. We need to show that the following sequence is also exact:
    \[0 \to \RHom{R}{M}{A} \overset{f_1 \circ -}{\to} \RHom{R}{M}{B} \overset{f_2 \circ -}{\to} \RHom{R}{M}{C} \to 0.\]
    Left-exactness is exactly the conclusion of \ref{lemma-covariant-hom-left-exact}.

    To show right-exactness, it suffices to show that \(f_2 \circ -\) is surjective. Fix \(h : M \to C\). By assumption, \(f_2\) is surjective. Then we are in the situation of \ref{projective-lifting}, so there exists a lift \(\wt{h} : M \to B\) of \(h\) along \(f_2\) such that \(f_2 \circ \wt{h} = h\).

    \item (\ref{projective-lifting} \(\implies\) \ref{projective-split}) Suppose that \(0 \to A \to B \overset{f}{\to} M \to 0\) is exact. Then \(f\) is an epimorphism, so there exists a lift \(g\) of the identity \(\operatorname{id} : M \to M\) along the surjection \(f\), such that \(f \circ g = \operatorname{id}\), so the sequence is split.
  \item \TODO(jesse)
  \end{itemize}
\end{proof}

\begin{lemma} \label{lemma-fg-projective-idempotent}
  Let \(M\) be a finitely-generated projective \(R\)-module . Then there exists an \(n\) and an idempotent \(e : \Mat_n(R)\) such that \(M \simeq e(R^n)\).
\end{lemma}

\begin{proof}
  \TODO(jesse).
\end{proof}

\begin{definition} \label{def-category-projective-modules}
  We define \(\fgProj(R)\) to be the full subcategory of \(R\text{-Mod}\) on the finitely-generated projective \(R\)-modules.
\end{definition}

\section{Swan's theorem}

Throughout this section, \(R\) denotes \(C(X)\), the ring of continuous functions on \(X\).

\begin{lemma}[\cite{swan1962vector}, Lemma 1]\label{lemma-1}
  Let \(x \in X\). Let \(E \overset{p}{\to} X\) be a vector bundle, and let \(t_1, \dots, t_k\) be sections of \(E\) over a neighborhood \(U \ni x\) such that \(t_1(x), \dots, t_k(x)\) are linearly independent.

  Then there is a neighborhood \(V \ni x\) such that for all \(y \in V\), \(t_1(y), \dots, t_k(y)\) are linearly independent.
\end{lemma}

\begin{proof}
  Without loss of generality, we may assume that \(U\) trivializes \(E\) at \(x\), and thus that we are in the situation of having continuous functions
  \[s_1, \dots, s_k : U \to \R^n\]
  such that \(s_1(x), \dots, s_k(x)\) are linearly independent.
  
  We identify \((s_1(x), \dots, s_k(x))\) with a linear transformation \(f_x : \R^k \to \R^n\). It suffices to show that there is a neighborhood \(V\) of \(x\) such that \(\mathbf{s} := (x \mapsto f_x)\) (which we claim is continuous) is injective on \(V\). Indeed, since \(f_x\) is continuous, there exists some left-inverse \(g\) of \(f_x\). Since the map
  \[(h \mapsto gh) : \Hom(\R^k, \R^n) \to \R\]
  is continuous, there exists a neighborhood \(V_0\) of \(f_x\) such that for every \(h \in V_0\), \(h\) is injective. Then we can take \(V = \mathbf{s}^{-1}(V_0)\).
\end{proof}

\begin{lemma}[Proposition 1, \cite{swan1962vector}]\label{lemma-proposition-1}
  Let \(f : (E,p) \to (E',o')\) be a map of vector bundles over \(X\). Then the following are equivalent:
  \begin{enumerate}[label={(\alph*)}]
  \item \label{lemma-proposition-1-1} \(\ker f\) is a subbundle of \((E,p)\). 
  \item \label{lemma-proposition-1-2} The dimensions of the fibers of \(ker f\) are locally constant.
  \end{enumerate}
\end{lemma}
\begin{proof}
  By \ref{lemma-rank-locally-constant}, the rank of a bundle is locally constant, so by definition, \ref{lemma-proposition-1-1} implies \ref{lemma-proposition-1-2}. For the converse, we must exhibit trivialization data for \(\ker f\), so let \(x \in X\). We will obtain an open set \(U\) which trivializes \(\ker f\) at \(x\) as follows. Let \(n\) be the rank of \(E\) at \(x\). Since \((E,p)\) is a bundle, we can choose a local base \(\{s_1, \cdots, s_n\}\) for \((E,p)\) at \(x\). We can number the \(s_1, \dots, s_n\) such that (for \(k\) the locally constant dimension of \(\im f\) near \(x\)) \(f \circ s_1, \dots, f \circ s_k\) form a local base for \((E',p')\) at \(f(x)\). It follows that there is a neighborhood \(U \ni x\) such that for all \(y \in U\), and for every \(i > k\), \(f \circ s_i(y) = \sum_{j = 1}^k a_{ij}(y) \cdot f \circ s_j(y).\) Then for every \(i\),
  \[s_i'(y) := s_i(y) - \sum_{j = 1}^k a_{ij}(y)s_j(y) : (\ker f)_y,\]
  and the $\{s_1, \cdots, s_{n - k}\}$ form a local base near \(x\), as required.
\end{proof}
\begin{lemma}[Proposition 2, \cite{swan1962vector}] \label{lemma-proposition-2}
  Any subbundle of a vector bundle \((E,p)\) over \(X\) is a direct summand.
\end{lemma}

\begin{proof}
  \TODO(jesse)
\end{proof}


\begin{lemma}[Lemma 5, \cite{swan1962vector}]\label{lemma-lemma-5}
  Let \((E,p)\) be a vector bundle over \(X\). Then there exists a trivial vector bundle \(X \times \R^n \overset{\pi_1}{\to} X\) and a vector bundle epimorphism \((X \times \R^n) \twoheadrightarrow E\).
\end{lemma}

\begin{proof}
  \TODO(jesse)
\end{proof}

\begin{lemma}
  \label{lemma-global-sections-projective}
  Let \((E,p)\) be a vector bundle over \(X\). Then \(\Gamma((E,p))\) is a projective \(R\)-module.
\end{lemma}

\begin{proof}
  By \ref{def-projective}, it suffices to show that every vector bundle over \(X\) is a direct summand of a trivial bundle over \(X\). Let \((E,p)\) be a vector bundle over \(X\).By \ref{lemma-lemma-5}, there exists some trivial bundle \(X \times \R^n \twoheadrightarrow X\) and an epimorphism \(f : X \times \R^n \twoheadrightarrow E\). Let \(\eta\) be the kernel of this epimorphism. By \ref{lemma-proposition-2}, \(\eta\) is a direct summand of \(X \times \R^n\), so there is some \(\eta'\) such that \(X \times \R^n \simeq \eta \oplus \eta'\). Let \(\iota_2 : \eta' \hookrightarrow \eta \oplus \eta'\) be the canonical inclusion. Then it is easy to check that \(f \circ \iota_2\) is an isomorphism \(\eta' \simeq (E,p)\).
\end{proof}

%TODO(jesse): maybe explicitly construct and name the inverse functor?
\begin{theorem}[Swan, \cite{swan1962vector}]
  The global sections functions induces an equivalence of categories
  \[\Gamma : \Vect(X) \overset{\sim}{\longrightarrow} \fgProj(X).\]
\end{theorem}

\begin{proof}
  \TODO(jesse)
\end{proof}

\section{Kaplansky's theorem on projective modules over local rings}

\begin{definition}\label{def-local-ring}
  Let \(R\) be a commutative ring. \(R\) is \textbf{local} if it has a unique maximal ideal.
\end{definition}

\begin{definition}\label{def-free-module}
  Let \(R\) be a commutative ring. Let \(M\) be an \(R\)-module. \(M\) is \textbf{free} if \(M\) has a basis; equivalently, if \(M\) is isomorphic to a direct sum of copies of \(R\).
\end{definition}

\begin{theorem}[Kaplansky]\label{thm-kaplansky}
  Let \(R\) be a local ring, and let \(M\) be a projective module over \(R\). Then \(M\) is free.
\end{theorem}

\begin{proof}
  \TODO(jesse)
\end{proof}

\section{Internalizing Kaplansky's theorem to \(\Shv(X)\)}

\bibliography{swan-notes}

\end{document}